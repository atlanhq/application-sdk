# table.yaml
entity: Table
columns:
  - name: attributes.name
    source: table_name
  - name: attributes.qualified_name
    source: concat(connection_qualified_name, '/', table_catalog, '/', table_schema, '/', table_name)
    source_columns: [connection_qualified_name, table_catalog, table_schema, table_name]
  - name: attributes.connectionQualifiedName
    source: connection_qualified_name
  - name: attributes.connectionName
    source: connection_name
  - name: attributes.description
    source: coalesce(remarks, comment)
    source_columns: [remarks, comment]
  - name: attributes.sourceCreatedBy
    source: source_owner
  - name: attributes.sourceCreatedAt
    source: created
  - name: attributes.sourceUpdatedAt
    source: last_altered
  - name: attributes.databaseName
    source: table_catalog
  - name: attributes.databaseQualifiedName
    source: concat(connection_qualified_name, '/', table_catalog)
    source_columns: [connection_qualified_name, table_catalog]
  - name: attributes.schemaName
    source: table_schema
  - name: attributes.schemaQualifiedName
    source: concat(connection_qualified_name, '/', table_catalog, '/', table_schema)
    source_columns: [connection_qualified_name, table_catalog, table_schema]
  - name: attributes.definition
    source: view_definition
  - name: attributes.columnCount
    source: column_count
  - name: attributes.rowCount
    source: row_count
  - name: attributes.sizeBytes
    source: size_bytes
  - name: attributes.tableType
    source: table_type
  - name: attributes.entityClass
    source: CASE WHEN is_partition = 'YES' THEN 'TablePartition' WHEN table_type IN ('TABLE', 'BASE TABLE', 'FOREIGN TABLE', 'PARTITIONED TABLE') THEN 'Table' WHEN table_type = 'MATERIALIZED VIEW' THEN 'MaterialisedView' WHEN table_type = 'DYNAMIC TABLE' OR is_dynamic = 'YES' THEN 'SnowflakeDynamicTable' ELSE 'View' END
    source_columns: [is_partition, table_type, is_dynamic]
  - name: attributes.tableName
    source: CASE WHEN is_partition = 'YES' THEN parent_table_name ELSE NULL END
    source_columns: [is_partition, parent_table_name]
  - name: attributes.tableQualifiedName
    source: CASE WHEN is_partition = 'YES' THEN concat(connection_qualified_name, '/', table_catalog, '/', table_schema, '/', parent_table_name) ELSE NULL END
    source_columns: [is_partition, connection_qualified_name, table_catalog, table_schema, parent_table_name]
  - name: attributes.externalLocation
    source: location
  - name: attributes.externalLocationFormat
    source: file_format_type
  - name: attributes.externalLocationRegion
    source: stage_region
  - name: attributes.refreshMode
    source: refresh_mode
  - name: attributes.staleness
    source: staleness
  - name: attributes.staleSinceDate
    source: stale_since_date
  - name: attributes.refreshMethod
    source: refresh_method
  - name: attributes.isTransient
    source: is_transient
  - name: attributes.tableCatalogId
    source: table_catalog_id
  - name: attributes.tableSchemaId
    source: table_schema_id
  - name: attributes.lastDdl
    source: last_ddl
  - name: attributes.lastDdlBy
    source: last_ddl_by
  - name: attributes.isSecure
    source: is_secure
  - name: attributes.retentionTime
    source: retention_time
  - name: attributes.stageUrl
    source: stage_url
  - name: attributes.isInsertableInto
    source: is_insertable_into
  - name: attributes.numberColumnsInPartKey
    source: number_columns_in_part_key
  - name: attributes.columnsParticipatingInPartKey
    source: columns_participating_in_part_key
  - name: attributes.isTyped
    source: is_typed
  - name: attributes.autoClusteringOn
    source: auto_clustering_on
  - name: attributes.engine
    source: engine
  - name: attributes.autoIncrement
    source: auto_increment
  - name: typeName
    source: "'Table'"