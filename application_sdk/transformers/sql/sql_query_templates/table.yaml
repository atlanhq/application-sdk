# table.yaml
table: Table
columns:
  - name: attributes.name
    source_query: table_name
  - name: attributes.qualified_name
    source_query: concat(connection_qualified_name, '/', table_catalog, '/', table_schema, '/', table_name)
    source_columns: [connection_qualified_name, table_catalog, table_schema, table_name]
  - name: attributes.connectionQualifiedName
    source_query: connection_qualified_name
  - name: attributes.connectionName
    source_query: connection_name
  - name: attributes.description
    source_query: coalesce(remarks, comment)
    source_columns: [remarks, comment]
  - name: attributes.sourceCreatedBy
    source_query: source_owner
  - name: attributes.sourceCreatedAt
    source_query: created
  - name: attributes.sourceUpdatedAt
    source_query: last_altered
  - name: attributes.databaseName
    source_query: table_catalog
  - name: attributes.databaseQualifiedName
    source_query: concat(connection_qualified_name, '/', table_catalog)
    source_columns: [connection_qualified_name, table_catalog]
  - name: attributes.schemaName
    source_query: table_schema
  - name: attributes.schemaQualifiedName
    source_query: concat(connection_qualified_name, '/', table_catalog, '/', table_schema)
    source_columns: [connection_qualified_name, table_catalog, table_schema]
  - name: attributes.definition
    source_query: view_definition
  - name: attributes.columnCount
    source_query: column_count
  - name: attributes.rowCount
    source_query: row_count
  - name: attributes.sizeBytes
    source_query: size_bytes
  - name: attributes.tableType
    source_query: table_type
  - name: attributes.entityClass
    source_query: CASE WHEN is_partition = 'YES' THEN 'TablePartition' WHEN table_type IN ('TABLE', 'BASE TABLE', 'FOREIGN TABLE', 'PARTITIONED TABLE') THEN 'Table' WHEN table_type = 'MATERIALIZED VIEW' THEN 'MaterialisedView' WHEN table_type = 'DYNAMIC TABLE' OR is_dynamic = 'YES' THEN 'SnowflakeDynamicTable' ELSE 'View' END
    source_columns: [is_partition, table_type, is_dynamic]
  - name: attributes.tableName
    source_query: CASE WHEN is_partition = 'YES' THEN parent_table_name ELSE NULL END
    source_columns: [is_partition, parent_table_name]
  - name: attributes.tableQualifiedName
    source_query: CASE WHEN is_partition = 'YES' THEN concat(connection_qualified_name, '/', table_catalog, '/', table_schema, '/', parent_table_name) ELSE NULL END
    source_columns: [is_partition, connection_qualified_name, table_catalog, table_schema, parent_table_name]
  - name: attributes.externalLocation
    source_query: location
  - name: attributes.externalLocationFormat
    source_query: file_format_type
  - name: attributes.externalLocationRegion
    source_query: stage_region
  - name: attributes.refreshMode
    source_query: refresh_mode
  - name: attributes.staleness
    source_query: staleness
  - name: attributes.staleSinceDate
    source_query: stale_since_date
  - name: attributes.refreshMethod
    source_query: refresh_method
  - name: attributes.isTransient
    source_query: is_transient
  - name: attributes.tableCatalogId
    source_query: table_catalog_id
  - name: attributes.tableSchemaId
    source_query: table_schema_id
  - name: attributes.lastDdl
    source_query: last_ddl
  - name: attributes.lastDdlBy
    source_query: last_ddl_by
  - name: attributes.isSecure
    source_query: is_secure
  - name: attributes.retentionTime
    source_query: retention_time
  - name: attributes.stageUrl
    source_query: stage_url
  - name: attributes.isInsertableInto
    source_query: is_insertable_into
  - name: attributes.numberColumnsInPartKey
    source_query: number_columns_in_part_key
  - name: attributes.columnsParticipatingInPartKey
    source_query: columns_participating_in_part_key
  - name: attributes.isTyped
    source_query: is_typed
  - name: attributes.autoClusteringOn
    source_query: auto_clustering_on
  - name: attributes.engine
    source_query: engine
  - name: attributes.autoIncrement
    source_query: auto_increment
  - name: attributes.isInsertableIntoTWO
    source_query: is_insertable_into
  - name: attributes.tenantId
    source_query: tenant_id
  - name: attributes.lastSyncWorkflowName
    source_query: last_sync_workflow_name
  - name: attributes.lastSyncRun
    source_query: last_sync_run
  - name: attributes.lastSyncRunAt
    source_query: last_sync_run_at
  - name: attributes.connectorName
    source_query: connector_name
  - name: typeName
    source_query: "'Table'"
  - name: status
    source_query: "'ACTIVE'"