# Transformers Documentation

This document provides a comprehensive overview of the Application SDK's transformers module, which handles the transformation of metadata into Atlas entities.

## Overview

The transformers module is organized into two main components:
1. Atlas Transformers: Handle transformation of SQL metadata into Atlas entities
2. Common Utilities: Provide shared functionality for text processing and name building

## Atlas SQL Transformers (`atlas/sql.py`)

### Base Entity Transformers
```python
class Database(assets.Database):
    """Database entity transformer for Atlas.
    
    Transforms database metadata into Atlas Database entities.
    
    Methods:
        get_attributes: Parse dictionary into Database entity attributes
    """

class Schema(assets.Schema):
    """Schema entity transformer for Atlas.
    
    Transforms schema metadata into Atlas Schema entities.
    
    Methods:
        get_attributes: Parse dictionary into Schema entity attributes
    """

class Table(assets.Table):
    """Table entity transformer for Atlas.
    
    Transforms table metadata into Atlas Table entities.
    
    Methods:
        get_attributes: Parse dictionary into Table entity attributes
    """

class Column(assets.Column):
    """Column entity transformer for Atlas.
    
    Transforms column metadata into Atlas Column entities.
    
    Methods:
        get_attributes: Parse dictionary into Column entity attributes
    """

class Function(assets.Function):
    """Function entity transformer for Atlas.
    
    Transforms function metadata into Atlas Function entities.
    
    Methods:
        creator: Create a new Function entity
        get_attributes: Parse dictionary into Function entity attributes
        
    Attributes:
        function_arguments: List of function arguments
    """

class Procedure(assets.Procedure):
    """Procedure entity transformer for Atlas.
    
    Transforms procedure metadata into Atlas Procedure entities.
    
    Methods:
        get_attributes: Parse dictionary into Procedure entity attributes
    """

class TagAttachment(assets.TagAttachment):
    """Tag attachment transformer for Atlas.
    
    Handles attachment of tags to Atlas entities.
    
    Methods:
        creator: Create a new TagAttachment entity
        get_attributes: Parse dictionary into TagAttachment entity attributes
    """
```

## Common Utilities (`common/utils.py`)

### Text Processing
```python
def process_text(text: str, max_length: int = 100000) -> str:
    """Process and sanitize text for storage.
    
    Args:
        text: The text to process
        max_length: Maximum length of text to keep (default: 100000)
        
    Returns:
        str: The processed text, truncated and sanitized
        
    Note:
        - Truncates text to max_length
        - Removes HTML tags
        - Converts to JSON-safe string
    """
```

### Name Building
```python
def build_phoenix_uri(connector_name: str, connector_type: str, *args: str) -> str:
    """Build the URI for a Phoenix entity.
    
    Args:
        connector_name: Name of the connector
        connector_type: Type of the connector
        *args: Additional path components
        
    Returns:
        str: The constructed URI path
        
    Example:
        >>> build_phoenix_uri("myconnector", "sql", "db", "schema")
        '/myconnector/sql/db/schema'
    """

def build_atlas_qualified_name(connection_qualified_name: str, *args: str) -> str:
    """Build the qualified name for an Atlas entity.
    
    Args:
        connection_qualified_name: Base qualified name for the connection
        *args: Additional name components
        
    Returns:
        str: The constructed qualified name
        
    Example:
        >>> build_atlas_qualified_name("tenant/connector/1", "db", "schema")
        'tenant/connector/1/db/schema'
    """
```

## Common Features and Best Practices

### Entity Transformation
1. Input Validation
   - Required fields are validated
   - Type checking is performed
   - Error messages are descriptive

2. Name Handling
   - Qualified names are properly constructed
   - URI paths are standardized
   - Special characters are handled

3. Relationship Management
   - Parent-child relationships are maintained
   - References are properly linked
   - Hierarchies are preserved

### Text Processing
1. Sanitization
   - HTML tags are removed
   - Whitespace is normalized
   - Special characters are handled

2. Length Management
   - Text is truncated if needed
   - Maximum lengths are configurable
   - Truncation is logged

### Error Handling
1. Validation Errors
   - Clear error messages
   - Proper exception types
   - Context preservation

2. Processing Errors
   - Graceful degradation
   - Error logging
   - Recovery mechanisms

### Best Practices
1. Code Quality
   - Type hints
   - Comprehensive documentation
   - Consistent naming
   - Clear error messages

2. Performance
   - Efficient text processing
   - Optimized name building
   - Minimal memory usage

3. Maintainability
   - Modular design
   - Clear separation of concerns
   - Reusable utilities
   - Testable components 